# Prompt Evaluator ê¸°ëŠ¥ ëª…ì„¸ì„œ

> **ë²„ì „**: 1.4.0
> **ìµœì¢… ìˆ˜ì •ì¼**: 2026-02-11

---

## 1. ê°œìš”

LLM í”„ë¡¬í”„íŠ¸ì˜ ì„±ëŠ¥ì„ ì •ëŸ‰ì ìœ¼ë¡œ ì¸¡ì •í•˜ê³  ì§€ì†ì ìœ¼ë¡œ ê°œì„ í•˜ê¸° ìœ„í•œ í‰ê°€ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
**LangSmith** ë˜ëŠ” **Langfuse**ë¥¼ í™œìš©í•˜ì—¬ ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

> **Note**: ê¸°ë³¸ê°’ `--backend both`ë¡œ ë‘ í”Œë«í¼ì—ì„œ ë™ì‹œì— ì‹¤í—˜ ì‹¤í–‰ ë° ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥

### 1.1. í•µì‹¬ ëª©í‘œ

- **ì •ëŸ‰ì  ì§€í‘œ í™•ë³´**: í”„ë¡¬í”„íŠ¸ ì„±ëŠ¥ì„ ì ìˆ˜í™”í•˜ì—¬ ê°ê´€ì  íŒë‹¨
- **ë²„ì „ ê´€ë¦¬ ë° ë¹„êµ**: í”„ë¡¬í”„íŠ¸ ìˆ˜ì • ì „í›„ ì„±ëŠ¥ ë³€í™” ë¹„êµ
- **í…ŒìŠ¤íŠ¸ ìë™í™”**: ë°˜ë³µì ì¸ í…ŒìŠ¤íŠ¸ ê³¼ì • ìë™í™”
- **íšŒê·€ ë°©ì§€**: í”„ë¡¬í”„íŠ¸ ë³€ê²½ ì‹œ ê¸°ì¡´ ì„±ëŠ¥ ì €í•˜ ìë™ ê°ì§€

### 1.2. ì„¤ê³„ ì›ì¹™

1. **ë“€ì–¼ ë°±ì—”ë“œ ì§€ì›**: LangSmith + Langfuse ë™ì‹œ ìš´ì˜, `backend` íŒŒë¼ë¯¸í„°ë¡œ ì„ íƒ
2. **ëª¨ë“ˆí™”ëœ íŒŒì´í”„ë¼ì¸**: ë°ì´í„°ë§Œ êµì²´í•˜ë©´ ë™ì¼ íŒŒì´í”„ë¼ì¸ ì¬ì‚¬ìš©
3. **ì ì§„ì  ë³µì¡ë„**: Rule-based â†’ LLM-Judge ìˆœì„œë¡œ í™•ì¥

---

## 2. ì‹œìŠ¤í…œ êµ¬ì„±

### 2.1. ë°ì´í„° íë¦„

```
[1. í‰ê°€ ëŒ€ìƒ í”„ë¡¬í”„íŠ¸]              [2. í‰ê°€ ë°ì´í„°ì…‹]
targets/{name}/prompt.*             datasets/{name}/
        â”‚                                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   í‰ê°€ íŒŒì´í”„ë¼ì¸      â”‚
        â”‚   (pipeline.py)      â”‚
        â”‚   backend= íŒŒë¼ë¯¸í„°   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                     â–¼
  [Rule-based]          [LLM Judge]
        â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                     â–¼
  [Langfuse ê¸°ë¡]       [LangSmith ê¸°ë¡]
  (ì…€í”„í˜¸ìŠ¤íŒ…)           (í´ë¼ìš°ë“œ)
```

---

## 3. í•µì‹¬ ê¸°ëŠ¥

### 3.1. í‰ê°€ì (Evaluators)

| ìœ í˜• | ì„¤ëª… | ë¹„ìš© | ìš©ë„ |
|------|------|:----:|------|
| **Rule-based** | í‚¤ì›Œë“œ, ê¸ˆì§€ì–´, í¬ë§· ê²€ì¦ | ë¬´ë£Œ | í•„ìˆ˜ ì¡°ê±´ ì²´í¬ |
| **String Distance** | ë¬¸ìì—´ í¸ì§‘ ê±°ë¦¬ | ë¬´ë£Œ | ì •ë‹µ ìœ ì‚¬ë„ |
| **Embedding Distance** | ë²¡í„° ìœ ì‚¬ë„ | ì €ë ´ | ì˜ë¯¸ì  ìœ ì‚¬ë„ |
| **LLM-as-Judge** | LLM ê¸°ë°˜ í‰ê°€ | ê³ ë¹„ìš© | í’ˆì§ˆ íŒë‹¨ |

#### Rule-based í‰ê°€ í•­ëª©

| ì§€í‘œ | ì„¤ëª… | ì ìˆ˜ |
|------|------|:----:|
| `keyword_inclusion` | í•„ìˆ˜ í‚¤ì›Œë“œ í¬í•¨ ë¹„ìœ¨ | 0.0~1.0 |
| `forbidden_word_check` | ê¸ˆì§€ì–´ í¬í•¨ ì—¬ë¶€ | 0 or 1 |

#### LLM Judge í‰ê°€ ê¸°ì¤€

criteriaëŠ” í•­ìƒ `ë„ë©”ì¸/ê¸°ì¤€ëª…` ì „ì²´ ê²½ë¡œë¡œ ì§€ì •í•©ë‹ˆë‹¤ (ì˜ˆ: `general/instruction_following`).

**ì¼ë°˜ (`general/`):**
- `general/instruction_following`: ì§€ì‹œì‚¬í•­ ì¤€ìˆ˜ë„
- `general/output_quality`: ì „ë°˜ì  ì¶œë ¥ í’ˆì§ˆ

**1on1 Meeting íŠ¹í™” (`oneonone/`):**
- `oneonone/professional_tone`: í†¤/ì–´ì¡° ì ì ˆì„±
- `oneonone/sensitive_topic_handling`: ë¯¼ê° ì£¼ì œ ì²˜ë¦¬
- `oneonone/header_format`: í—¤ë” í˜•ì‹ ì¤€ìˆ˜
- `oneonone/section_count`: ì„¹ì…˜ ê°œìˆ˜ ë²”ìœ„
- ì™¸ ë‹¤ìˆ˜

### 3.2. ì‹¤í–‰ ëª¨ë“œ

| ëª¨ë“œ | í‰ê°€ì | ìš©ë„ |
|------|--------|------|
| `quick` | Rule-basedë§Œ | ê°œë°œ ì¤‘ ë¹ ë¥¸ ê²€ì¦ |
| `full` | Rule + LLM Judge | ì •ì‹ í‰ê°€ |

### 3.3. í‰ê°€ í”Œë«í¼ ì—°ë™

#### LangSmith

LangSmithëŠ” LangChain íŒ€ì—ì„œ ì œê³µí•˜ëŠ” í´ë¼ìš°ë“œ ê¸°ë°˜ LLM observability í”Œë«í¼ì…ë‹ˆë‹¤.

- **Dataset**: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ LangSmithì— ì—…ë¡œë“œ
- **Experiment**: í‰ê°€ ì‹¤í–‰ ë° ê²°ê³¼ ê¸°ë¡
- **Prompt Hub**: í”„ë¡¬í”„íŠ¸ ë²„ì „ ê´€ë¦¬
- **Tracing**: LLM í˜¸ì¶œ ì¶”ì /ë””ë²„ê¹… (í™˜ê²½ë³€ìˆ˜ë§Œìœ¼ë¡œ ìë™ í™œì„±í™”)

#### Langfuse

LangfuseëŠ” LLM ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ observability í”Œë«í¼ì…ë‹ˆë‹¤.

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **íŠ¸ë ˆì´ì‹±** | LLM í˜¸ì¶œ, ì²´ì¸ ì‹¤í–‰, ë„êµ¬ ì‚¬ìš© ë“± ì „ì²´ ì‹¤í–‰ íë¦„ ì¶”ì  |
| **í”„ë¡¬í”„íŠ¸ ê´€ë¦¬** | ë²„ì „ ê´€ë¦¬, ë ˆì´ë¸”(production ë“±), SDK ì—°ë™ |
| **ë°ì´í„°ì…‹** | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê´€ë¦¬, CSV ì—…ë¡œë“œ, ë²„ì „ ê´€ë¦¬ |
| **í‰ê°€ (Evaluation)** | LLM-as-Judge, ì»¤ìŠ¤í…€ í‰ê°€ì, ì ìˆ˜(Score) ê¸°ë¡ |
| **ì‹¤í—˜ (Experiments)** | ë°ì´í„°ì…‹ ê¸°ë°˜ í‰ê°€ ì‹¤í–‰ ë° ê²°ê³¼ ë¹„êµ |
| **Playground** | í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸ ë° ë°˜ë³µ ê°œì„  |

#### LangSmith vs Langfuse ë¹„êµ

| í•­ëª© | LangSmith | Langfuse |
|------|-----------------|----------|
| **í˜¸ìŠ¤íŒ…** | í´ë¼ìš°ë“œ only | ì…€í”„í˜¸ìŠ¤íŒ… ê°€ëŠ¥ (ì˜¤í”ˆì†ŒìŠ¤) |
| **ë¹„ìš©** | ìœ ë£Œ (trace ê¸°ë°˜ ê³¼ê¸ˆ) | ì…€í”„í˜¸ìŠ¤íŒ… ì‹œ ë¬´ë£Œ |
| **í”„ë¡¬í”„íŠ¸ ê´€ë¦¬** | LangChain Hub | ìì²´ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ |
| **ë°ì´í„°ì…‹** | `langsmith.evaluate()` | `langfuse.create_dataset()` |
| **í‰ê°€ ì‹¤í–‰** | `evaluate()` í•¨ìˆ˜ | ë°ì´í„°ì…‹ ì‹¤í—˜ + `create_score()` |
| **LangChain ì—°ë™** | ë„¤ì´í‹°ë¸Œ í†µí•© | CallbackHandler ë°©ì‹ |
| **íŠ¸ë ˆì´ì‹±** | ìë™ (í™˜ê²½ë³€ìˆ˜) | CallbackHandler ë˜ëŠ” @observe |

#### ë°±ì—”ë“œ ì„ íƒ

| ë°±ì—”ë“œ | ì„¤ëª… | ìë™ ë²„ì „ê´€ë¦¬ |
|--------|------|:-------------:|
| `both` (ê¸°ë³¸ê°’) | Langfuse â†’ LangSmith ìˆœì„œë¡œ ë™ì‹œ ì‹¤í–‰ | âœ… (ì–‘ìª½) |
| `langfuse` | Langfuseë§Œ ì‹¤í–‰ | - |
| `langsmith` | LangSmithë§Œ ì‹¤í–‰ | âœ… |

#### ê¸°ëŠ¥ ì œí•œì‚¬í•­

| ê¸°ëŠ¥ | LangSmith | Langfuse |
|------|-----------|----------|
| ìë™ íŠ¸ë ˆì´ì‹± | í™˜ê²½ë³€ìˆ˜ë§Œìœ¼ë¡œ í™œì„±í™” | CallbackHandler í•„ìš” |
| í”„ë¡¬í”„íŠ¸ Hub | ìˆìŒ | ì—†ìŒ (ìì²´ ê´€ë¦¬) |
| ì‹¤í—˜ ë¹„êµ UI | ë‚´ì¥ | ê¸°ë³¸ ì œê³µ |

#### í†µí•© ìœ í‹¸ë¦¬í‹° êµ¬ì¡°

ëª¨ë“  ë°±ì—”ë“œ ì—°ë™ì€ `prompt_evaluator/utils/` í•˜ìœ„ ëª¨ë“ˆë¡œ í†µí•© ê´€ë¦¬ë©ë‹ˆë‹¤:

```
prompt_evaluator/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ prompt_sync.py          # í”„ë¡¬í”„íŠ¸ ì—…ë¡œë“œ/ì¡°íšŒ (LangSmith + Langfuse í†µí•©)
â”‚   â”œâ”€â”€ dataset_sync.py         # ë°ì´í„°ì…‹ ì—…ë¡œë“œ/ì¡°íšŒ (LangSmith + Langfuse í†µí•©)
â”‚   â””â”€â”€ langfuse_client.py      # Langfuse ì‹±ê¸€í†¤ í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ evaluators/adapters.py      # LLM Judge ì–´ëŒ‘í„° (LangSmith/Langfuse í˜•ì‹ ë³€í™˜)
â””â”€â”€ pipelines/pipeline.py       # run_experiment(backend=...)
```

**í†µí•© API ì‚¬ìš© ì˜ˆì‹œ:**

```python
from prompt_evaluator.utils.prompt_sync import push_prompt, get_prompt, list_prompt_versions

# í”„ë¡¬í”„íŠ¸ ì—…ë¡œë“œ (backend ì„ íƒ ê°€ëŠ¥)
result = push_prompt("my_prompt", backend="langfuse")       # Langfuseë§Œ
result = push_prompt("my_prompt", backend="both")           # ì–‘ìª½ ë™ì‹œ

# í”„ë¡¬í”„íŠ¸ ì¡°íšŒ
template = get_prompt("my_prompt", backend="langfuse")

# ë²„ì „ ëª©ë¡ (LangSmith)
versions = list_prompt_versions("my_prompt")
```

```python
from prompt_evaluator.utils.dataset_sync import upload_dataset, get_dataset

# ë°ì´í„°ì…‹ ì—…ë¡œë“œ (backend ì„ íƒ ê°€ëŠ¥)
result = upload_dataset("my_prompt", backend="langfuse")    # Langfuseë§Œ
result = upload_dataset("my_prompt", backend="both")        # ì–‘ìª½ ë™ì‹œ

# ë°ì´í„°ì…‹ ì¡°íšŒ (Langfuse)
dataset = get_dataset("my_prompt")
```

```python
from prompt_evaluator.pipelines.pipeline import run_experiment

# í†µí•© ì‹¤í—˜ ì‹¤í–‰ (backend íŒŒë¼ë¯¸í„°ë¡œ ì„ íƒ)
run_experiment(
    prompt_name="my_prompt",
    mode="full",
    backend="langfuse",        # "langfuse" | "langsmith" | "both"
)
```

#### Langfuse ì…€í”„í˜¸ìŠ¤íŒ… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Langfuse                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Web UI (port 3000)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL     â”‚  ClickHouse     â”‚  Redis          â”‚
â”‚  (íŠ¸ëœì­ì…˜)      â”‚  (íŠ¸ë ˆì´ìŠ¤ ì €ì¥) â”‚  (í/ìºì‹œ)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### GCP í´ë¼ìš°ë“œ ë°°í¬ ì•„í‚¤í…ì²˜

ë¡œì»¬ Docker í™˜ê²½ì˜ Langfuseë¥¼ GCPì— ë°°í¬í•˜ì—¬ íŒ€ ê³µìœ  í™˜ê²½ì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

**ì±„íƒ: GCE ë‹¨ì¼ VM + Docker Compose + Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ**

```
                    http://34.64.193.193
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GCE VM: langfuse-vm (e2-standard-4, ì„œìš¸)          â”‚
â”‚  Ubuntu 22.04 LTS / SSD 80GB                        â”‚
â”‚                          â”‚                           â”‚
â”‚  Nginx (í˜¸ìŠ¤íŠ¸, :80) â”€â”€â”€ Basic Auth â”€â”€â”              â”‚
â”‚    /api/* â†’ auth off                  â”‚              â”‚
â”‚    /*     â†’ auth required             â”‚              â”‚
â”‚                          â†“            â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Docker Compose                              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚ langfuse   â”‚ â”‚ langfuse   â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  -web      â”‚ â”‚  -worker   â”‚               â”‚    â”‚
â”‚  â”‚  â”‚ (:3000)    â”‚ â”‚ (:3030)    â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚PostgreSQLâ”‚ â”‚ClickHouseâ”‚ â”‚  Redis   â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ (:5432)  â”‚ â”‚(:8123/   â”‚ â”‚ (:6379)  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚          â”‚ â”‚  :9000)  â”‚ â”‚          â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚    â”‚
â”‚  â”‚  â”‚  MinIO   â”‚                                â”‚    â”‚
â”‚  â”‚  â”‚(:9000/   â”‚                                â”‚    â”‚
â”‚  â”‚  â”‚  :9001)  â”‚                                â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  Volumes: postgres_data, clickhouse_data,            â”‚
â”‚           clickhouse_logs, minio_data                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì¸í”„ë¼ êµ¬ì„±:**

| í•­ëª© | ì„¤ì • |
|------|------|
| GCP í”„ë¡œì íŠ¸ | `thetimecollabo` |
| VM | `langfuse-vm` (e2-standard-4, 4 vCPU, 16GB RAM) |
| ë¦¬ì „ | `asia-northeast3` (ì„œìš¸) |
| OS | Ubuntu 22.04 LTS |
| ë””ìŠ¤í¬ | SSD Persistent Disk 80GB |
| ê³ ì • IP | `34.64.193.193` |
| ì ‘ê·¼ ì œì–´ | Nginx Basic Auth (UI) + API Key (SDK) |

**Docker ë¦¬ì†ŒìŠ¤ ìš”êµ¬ì‚¬í•­:**

- PostgreSQL, ClickHouse, Redis ë™ì‹œ ì‹¤í–‰
- ìµœì†Œ 8GB RAM ê¶Œì¥
- ë””ìŠ¤í¬ ê³µê°„: 10GB ì´ìƒ

#### íŠ¸ë ˆì´ì‹±

ëª¨ë“  LLM í˜¸ì¶œì— Langfuse íŠ¸ë ˆì´ì‹±ì´ ì ìš©ë©ë‹ˆë‹¤:

- `prompt_evaluator/pipelines/pipeline.py`: `execute_prompt()`ì— `callbacks` íŒŒë¼ë¯¸í„° (execution LLM íŠ¸ë ˆì´ì‹±)
- `prompt_evaluator/evaluators/adapters.py`: Langfuse ì–´ëŒ‘í„°ì—ì„œ `judge_llm.with_config()`ìœ¼ë¡œ callbacks ë°”ì¸ë”©
- Langfuse ì‹¤í—˜ ì‹œ `get_langfuse_handler()` ìë™ ìƒì„±

LLM JudgeëŠ” `llm` íŒŒë¼ë¯¸í„° ì£¼ì… ë°©ì‹ìœ¼ë¡œ íŠ¸ë ˆì´ì‹±í•©ë‹ˆë‹¤:

```python
# execution LLM: callbacks íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
handler = get_langfuse_handler()
output = execute_prompt(template, inputs, callbacks=[handler])

# judge LLM: callbacksê°€ ë°”ì¸ë”©ëœ LLM ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì£¼ì…
bound_judge = judge_llm.with_config({"callbacks": [handler]})
results = run_checklist_evaluation(output=text, inputs=input, llm=bound_judge)
```

#### ì˜ì‚¬ê²°ì • ë°©í–¥ì„±

**ë‹¨ê¸° (í˜„ì¬)**:
- **LangSmith + Langfuse ë³‘í–‰ ìš´ì˜**
  - `--backend both` ê¸°ë³¸ê°’ìœ¼ë¡œ ë‘ í”Œë«í¼ ë™ì‹œ ì‹¤í–‰
  - í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸ ì‹œ ì–‘ìª½ UIì—ì„œ ëª¨ë‹ˆí„°ë§
  - LangSmithì˜ ì§ê´€ì ì¸ í‰ê°€ UI + Langfuseì˜ ì…€í”„í˜¸ìŠ¤íŒ… ì¥ì  í™œìš©

**ì¥ê¸° (ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ í›„)**:
- **Langfuse ë‹¨ë… ì‚¬ìš©**
  - íŠ¸ë ˆì´ì‹± ê¸°ëŠ¥ê¹Œì§€ ì™„ì „ ì´ì „ í›„ LangSmith ë¹„í™œì„±í™”
  - ìƒì„¸ ìŠ¤ì½”ì–´ë§ ë¡œê·¸ â†’ ì»¤ìŠ¤í…€ ë¦¬í¬íŠ¸ ìƒì„±
  - commentì— JSON êµ¬ì¡°í™” â†’ APIë¡œ ì¶”ì¶œ â†’ ë³„ë„ ë¦¬í¬íŠ¸/ëŒ€ì‹œë³´ë“œ

---

## 4. íŒŒì¼ í˜•ì‹

### 4.1. í”„ë¡¬í”„íŠ¸ íŒŒì¼ (targets/{name}/prompt.*)

**ì§€ì› í˜•ì‹:**

| í˜•ì‹ | íŒŒì¼ëª… | ì„¤ëª… |
|------|--------|------|
| `.txt` | `prompt.txt` | ë‹¨ì¼ í…œí”Œë¦¿ í…ìŠ¤íŠ¸ |
| `.md` | `prompt.md` | ë§ˆí¬ë‹¤ìš´ í˜•ì‹ |
| `.py` | `prompt.py` | Python ë³€ìˆ˜ (`*_PROMPT`) |
| `.xml` | `prompt.xml` | XML êµ¬ì¡° |

**ì˜ˆì‹œ (.txt):**
```
ë‹¹ì‹ ì€ {role}ì…ë‹ˆë‹¤.

ì‚¬ìš©ì ì§ˆë¬¸: {query}
ì»¨í…ìŠ¤íŠ¸: {context}

ìœ„ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.
```

### 4.2. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ (datasets/{name}/test_cases.json)

```json
[
  {
    "id": "case_001",
    "description": "ê¸°ë³¸ íë¦„ í…ŒìŠ¤íŠ¸",
    "inputs": {
      "role": "ì¹œì ˆí•œ ê³ ê°ìƒë‹´ì‚¬",
      "query": "í™˜ë¶ˆ ì ˆì°¨ê°€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?",
      "context": "7ì¼ ì´ë‚´ í™˜ë¶ˆ ê°€ëŠ¥"
    }
  }
]
```

### 4.3. ê¸°ëŒ€ ê²°ê³¼ (datasets/{name}/expected.json)

```json
{
  "case_001": {
    "keywords": ["í™˜ë¶ˆ", "7ì¼"],
    "forbidden": ["ë¶ˆê°€ëŠ¥", "ì•ˆë©ë‹ˆë‹¤"],
    "reference": {}
  }
}
```

### 4.4. í‰ê°€ ì„¤ì • (targets/{name}/config.yaml)

```yaml
name: prep_generate
description: 1on1 Prep Report ìƒì„± í”„ë¡¬í”„íŠ¸
output_format: text  # text | json

evaluators:
  - type: rule_based
    checks:
      - keyword_inclusion
      - forbidden_word_check

  - type: llm_judge
    enabled: true
    criteria:
      - general/instruction_following      # í•­ìƒ 'ë„ë©”ì¸/ê¸°ì¤€ëª…' ì „ì²´ ê²½ë¡œ
      - general/output_quality
      - oneonone/professional_tone

thresholds:
  pass_rate: 0.85
  min_score: 0.70

run_mode: quick  # quick | full
```

---

## 5. CLI ëª…ë ¹ì–´

```bash
# íŒ¨í‚¤ì§€ ì„¤ì¹˜ í›„
prompt-eval <command> [options]

# ë˜ëŠ” ê°œë°œ ì‹œ
poetry run python main.py <command> [options]
```

| ëª…ë ¹ì–´ | ì„¤ëª… |
|--------|------|
| `init --dir {dir} --targets-dir {path}` | í‰ê°€ í™˜ê²½ ì´ˆê¸°í™” |
| `experiment --name {name}` | í‰ê°€ ì‹¤í–‰ (ê¸°ë³¸: Langfuse + LangSmith ë™ì‹œ) |
| `experiment --name {name} --backend {backend}` | ë°±ì—”ë“œ ì§€ì • (langsmith/langfuse/both) |
| `regression --name {name} --experiment {exp}` | íšŒê·€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ |
| `validate --name {name}` | config ê²€ì¦ |
| `list` | í‰ê°€ ì„¸íŠ¸ ëª©ë¡ |
| `upload --name {name}` | ë°ì´í„°ì…‹ LangSmith ì—…ë¡œë“œ |
| `prompt info/init/push/pull/versions` | í”„ë¡¬í”„íŠ¸ ë²„ì „ ê´€ë¦¬ |
| `baseline list/set/delete` | ê¸°ì¤€ì„  ê´€ë¦¬ |

> ìƒì„¸ ì‚¬ìš©ë²•ì€ [CLI ë ˆí¼ëŸ°ìŠ¤](./features/cli-reference.md) ì°¸ì¡°

---

## 6. í‰ê°€ ì›Œí¬í”Œë¡œìš°

```
[1. ë°ì´í„°ì…‹ êµ¬ì¶•]
       â”‚
       â–¼
[2. í”„ë¡¬í”„íŠ¸ ì‘ì„±/ìˆ˜ì •] â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                      â”‚
       â–¼                                      â”‚
[3. í‰ê°€ ì‹¤í–‰] â”€â”€â”€â”€â”€â–º [4. ê²°ê³¼ ë¶„ì„] â”€â”€â”€â”€â”€â–º [5. ê°œì„ ]
       â”‚                    â”‚
       â–¼                    â–¼
  LangSmith ê¸°ë¡      ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ë¶„ì„
```

### 6.1. íšŒê·€ í…ŒìŠ¤íŠ¸ ê¸°ì¤€

| ì§€í‘œ | í—ˆìš© ë³€ë™í­ | ì¡°ì¹˜ |
|------|:----------:|------|
| í‰ê·  ì ìˆ˜ | -0.2 ì´ë‚´ | ì´ˆê³¼ ì‹œ ë¨¸ì§€ ì°¨ë‹¨ |
| Pass Rate | -5% ì´ë‚´ | ì´ˆê³¼ ì‹œ ê²½ê³  |
| íŠ¹ì • ì¼€ì´ìŠ¤ ì‹¤íŒ¨ | Pass â†’ Fail | ë°˜ë“œì‹œ ë¦¬ë·° í•„ìš” |

---

## 7. ë¹„ìš© ì¶”ì • (100ê°œ í…ŒìŠ¤íŠ¸ ê¸°ì¤€)

| êµ¬ì„±ìš”ì†Œ | ë‹¨ê°€ | 100íšŒ ë¹„ìš© |
|----------|:----:|:----------:|
| íƒ€ê²Ÿ LLM í˜¸ì¶œ (GPT-4o) | ~$0.01/call | ~$1.00 |
| LLM-Judge (GPT-4o) | ~$0.01/call | ~$1.00 |
| Embedding (ada-002) | ~$0.0001/call | ~$0.01 |
| **ì´í•©** | | **~$2.00** |

---

## 8. í–¥í›„ ê³„íš

### êµ¬í˜„ ì™„ë£Œ

| í•­ëª© | ìƒíƒœ | ë¬¸ì„œ |
|------|:----:|------|
| í”„ë¡¬í”„íŠ¸ ë²„ì „ ê´€ë¦¬ (Phase 1) | âœ… | [versioning.md](./features/versioning.md) |
| íšŒê·€ í…ŒìŠ¤íŠ¸ ì²´ê³„ (Phase 2) | âœ… | [regression.md](./features/regression.md) |
| Langfuse í†µí•© (Phase 2.5) | âœ… | ë³¸ ë¬¸ì„œ Section 3.3 |
| CLI ëª¨ë“ˆí™” | âœ… | [cli-reference.md](./features/cli-reference.md) |
| ìœ í‹¸ë¦¬í‹° í†µí•© (prompt_sync + dataset_sync) | âœ… | ë³¸ ë¬¸ì„œ Section 3.3 |
| íŒ¨í‚¤ì§€í™” (pip install) | âœ… | [PACKAGING_PLAN.md](./PACKAGING_PLAN.md) |
| GCP í´ë¼ìš°ë“œ ë°°í¬ | ğŸ”„ | ì¸í”„ë¼/ë°°í¬/ë³´ì•ˆ ì™„ë£Œ, ìš´ì˜ ë‚¨ìŒ |

### ë¯¸êµ¬í˜„ í•­ëª©

| í•­ëª© | ìš°ì„ ìˆœìœ„ | ìƒíƒœ |
|------|:--------:|:----:|
| GitHub Actions CI/CD | P1 | ëŒ€ê¸° |
| ì‹¤íŒ¨ ë¶„ì„ ë¦¬í¬íŠ¸ (Phase 3) | P1 | ëŒ€ê¸° |
| LLM ì‘ë‹µ ìºì‹± | P2 | ëŒ€ê¸° |
| Human spot-check (Phase 4) | P2 | ëŒ€ê¸° |
| Slack ì•Œë¦¼ ì—°ë™ | P3 | ëŒ€ê¸° |

### í‰ê°€ ì²´ê³„ ì„±ìˆ™ë„ ë¡œë“œë§µ

```
[í˜„ì¬] Stage 1: Bootstrap
â”œâ”€â”€ ìë™ìƒì„±ìœ¼ë¡œ ë¹ ë¥¸ ì‹œì‘
â”œâ”€â”€ ê¸°ë³¸ í‰ê°€ ê¸°ì¤€ìœ¼ë¡œ MVP ê²€ì¦
â””â”€â”€ í”¼ë“œë°± ë£¨í”„ êµ¬ì¶•

[ë‹¤ìŒ] Stage 2: Curate
â”œâ”€â”€ ì‹¤ì „ ì¢‹ì€/ë‚˜ìœ ì¶œë ¥ ìˆ˜ì§‘
â”œâ”€â”€ Golden Dataset ì ì§„ì  êµ¬ì¶•
â””â”€â”€ ìë™ìƒì„± í‰ê°€ê¸°ì¤€ ê²€ì¦ & ìˆ˜ì •

[í–¥í›„] Stage 3: Refine
â”œâ”€â”€ ì‹¤ì „ ë°ì´í„° ê¸°ë°˜ í‰ê°€ê¸°ì¤€ ì¬ì •ì˜
â”œâ”€â”€ Edge case ì¤‘ì‹¬ í…ŒìŠ¤íŠ¸ ê°•í™”
â””â”€â”€ ë„ë©”ì¸ ì „ë¬¸ê°€ ë¦¬ë·° ë°˜ì˜
```

---

## 9. ì°¸ê³  ë¬¸ì„œ

### ê¸°ëŠ¥ë³„ ìƒì„¸
- [ë²„ì „ ê´€ë¦¬](./features/versioning.md) - í”„ë¡¬í”„íŠ¸ ë²„ì „ ì¶”ì 
- [íšŒê·€ í…ŒìŠ¤íŠ¸](./features/regression.md) - ê¸°ì¤€ì„  ë¹„êµ ë° ì„±ëŠ¥ ì €í•˜ ê°ì§€
- [CLI ë ˆí¼ëŸ°ìŠ¤](./features/cli-reference.md) - ì „ì²´ CLI ëª…ë ¹ì–´
- [Langfuse ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš](./langfuse-migration-plan.md) - Langfuse í†µí•© ìƒì„¸

### ê°€ì´ë“œ
- [ì‚¬ìš© ê°€ì´ë“œ](../prompt_evaluator/GUIDE.md) - í‰ê°€ ì²´ê³„ í™œìš© ë°©ë²•
- [LangSmith í”„ë¡¬í”„íŠ¸ ê´€ë¦¬](./LANGSMITH_PROMPTS.md) - LangSmith ì—°ë™ ìƒì„¸
- [PromptOps ê¸°íšì„œ](./PROMPTOPS_PLAN.md) - ì „ì²´ ë¡œë“œë§µ
